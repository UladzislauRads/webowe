import pygame
import random
import math

# Inicjalizacja Pygame
pygame.init()

# Wymiary okna
WIDTH = 1000
HEIGHT = 700
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption(" Choinka ze niegiem ")

# Kolory
WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
DARK_BLUE = (25, 25, 112)
GREEN = (34, 139, 34)
DARK_GREEN = (0, 100, 0)
BROWN = (139, 69, 19)
RED = (220, 20, 60)
GOLD = (255, 215, 0)
LIGHT_BLUE = (173, 216, 230)

# Zegar do kontroli FPS
clock = pygame.time.Clock()
font = pygame.font.Font(None, 36)


# Klasa dla nie偶ynek
class Snowflake:
    def __init__(self):
        self.x = random.randint(0, WIDTH)
        self.y = random.randint(-50, HEIGHT)
        self.size = random.randint(1, 3)
        self.speed_y = random.uniform(0.5, 2)
        self.speed_x = random.uniform(-0.5, 0.5)
        self.opacity = 200

    def update(self):
        self.y += self.speed_y
        self.x += self.speed_x

        # Delikatne wahania
        if random.random() < 0.1:
            self.speed_x += random.uniform(-0.2, 0.2)
            self.speed_x = max(-1, min(1, self.speed_x))

        # Wznowienie na g贸rze, jeli wypadnie na d贸
        if self.y > HEIGHT:
            self.y = -10
            self.x = random.randint(0, WIDTH)

        # Zawijanie wok贸 bok贸w
        if self.x > WIDTH:
            self.x = 0
        elif self.x < 0:
            self.x = WIDTH

    def draw(self, surface):
        pygame.draw.circle(surface, WHITE, (int(self.x), int(self.y)), self.size)


# Klasa dla ozdoby choinki
class Ornament:
    def __init__(self, x, y, color):
        self.x = x
        self.y = y
        self.color = color
        self.radius = 4

    def draw(self, surface):
        pygame.draw.circle(surface, self.color, (self.x, self.y), self.radius)
        # Byszczcy efekt
        pygame.draw.circle(surface, WHITE, (self.x - 1, self.y - 1), 1)


# Funkcja do rysowania choinki
def draw_tree(surface, x, y, size):
    # Tr贸jkty choinki
    triangles = [
        # (x, y, width, height) - stosunkowo do centrum
        [(x, y - size), (x - size // 2, y), (x + size // 2, y)],
        [(x, y + size // 3 - size), (x - size // 1.5, y + size // 3), (x + size // 1.5, y + size // 3)],
        [(x, y + 2 * size // 3 - size), (x - size, y + 2 * size // 3), (x + size, y + 2 * size // 3)],
    ]

    for triangle in triangles:
        pygame.draw.polygon(surface, GREEN, triangle)
        pygame.draw.polygon(surface, DARK_GREEN, triangle, 2)

    # Pie choinki
    trunk_width = size // 6
    trunk_height = size // 3
    trunk_x = x - trunk_width // 2
    trunk_y = y + 2 * size // 3
    pygame.draw.rect(surface, BROWN, (trunk_x, trunk_y, trunk_width, trunk_height))

    # Ozdoby (kulki)
    ornaments = [
        # Pierwszy poziom
        Ornament(x - size // 4, y + size // 6, RED),
        Ornament(x + size // 4, y + size // 6, RED),
        Ornament(x, y + size // 4, GOLD),
        # Drugi poziom
        Ornament(x - size // 2, y + 2 * size // 3, GOLD),
        Ornament(x + size // 2, y + 2 * size // 3, RED),
        Ornament(x, y + size // 2, RED),
        # Trzeci poziom
        Ornament(x - size // 1.3, y + size, GOLD),
        Ornament(x + size // 1.3, y + size, GOLD),
        Ornament(x, y + 5 * size // 6, RED),
    ]

    for ornament in ornaments:
        ornament.draw(surface)

    # Gwiazda na czubku
    star_x = x
    star_y = y - size - 20
    star_size = size // 8
    draw_star(surface, star_x, star_y, star_size, GOLD)


# Funkcja do rysowania gwiazdy
def draw_star(surface, x, y, size, color):
    points = []
    for i in range(10):
        angle = i * math.pi / 5
        if i % 2 == 0:
            r = size
        else:
            r = size // 2
        px = x + r * math.sin(angle)
        py = y - r * math.cos(angle)
        points.append((px, py))
    pygame.draw.polygon(surface, color, points)
    pygame.draw.polygon(surface, WHITE, points, 1)


# G贸wna ptla gry
snowflakes = [Snowflake() for _ in range(150)]
running = True
frame_count = 0

while running:
    clock.tick(60)  # 60 FPS
    frame_count += 1

    # Obsuga zdarze
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_ESCAPE:
                running = False

    # Czyszczenie ekranu - nocne niebo
    screen.fill(DARK_BLUE)

    # Aktualizacja i rysowanie nie偶ynek
    for snowflake in snowflakes:
        snowflake.update()
        snowflake.draw(screen)

    # Rysowanie choinki
    draw_tree(screen, WIDTH // 2, HEIGHT // 2 + 50, 120)

    # Napis witeczny
    text = font.render("Wesoych wit!  锔", True, GOLD)
    text_rect = text.get_rect(center=(WIDTH // 2, 50))
    screen.blit(text, text_rect)

    # Aktualizacja ekranu
    pygame.display.flip()

# Zamknicie
pygame.quit()
